!function(n,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():n.Vow=t()}(this,function(){"use strict";function n(n){function e(n){if(l===c.PENDING){if(f===r)return i(new TypeError("Cannot fulfill Promise with itself!")),void 0;if(n instanceof f.constructor)return n.then(function(n){e(n)},function(n){i(n)}),void 0;if("object"==typeof n||"function"==typeof n){var u;try{u=n.then}catch(s){return i(s),void 0}if("function"==typeof u){var h=!1;try{u.call(n,function(n){h||(h=!0,e(n))},function(n){h||(h=!0,i(n))})}catch(s){h||i(s)}return}}l=c.FULFILLED,r=n,t(function(){for(;d.length;)o(d.shift())})}}function i(n){l===c.PENDING&&(l=c.REJECTED,u=n,t(function(){for(;d.length;)o(d.shift())}))}function o(n){return l===c.PENDING?(d.push(n),void 0):(t(function(){var t;if(l===c.FULFILLED){if(n.onFulfilled){try{t=n.onFulfilled(r)}catch(e){return n.reject(e),void 0}return n.fulfill(t),void 0}return n.fulfill(r),void 0}if(n.onRejected){try{t=n.onRejected(u)}catch(e){return n.reject(e),void 0}return n.fulfill(t),void 0}n.reject(u)}),void 0)}var f=this,r=null,u=null,c={PENDING:"pending",FULFILLED:"fulfilled",REJECTED:"rejected"},l=c.PENDING,d=[];f.then=function(n,t){return new f.constructor(function(e,i){o({onFulfilled:"function"==typeof n?n:null,onRejected:"function"==typeof t?t:null,fulfill:e,reject:i})})},n(e,i)}var t;return t=process&&process.nextTick?process.nextTick:function(n){return setTimeout(n,1)},n});