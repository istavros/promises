!function(t,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():t.Vow=n()}(this,function(){function t(t){function n(t){if(c===r.PENDING){if(o===f)return e(new TypeError("Cannot fulfill Promise with itself!")),void 0;if(t instanceof o.constructor)return t.then(function(t){n(t)},function(t){e(t)}),void 0;if("object"==typeof t||"function"==typeof t){var u;try{u=t.then}catch(d){return e(d),void 0}if("function"==typeof u){var h=!1;try{u.call(t,function(t){h||(h=!0,n(t))},function(t){h||(h=!0,e(t))})}catch(d){h||e(d)}return}}c=r.FULFILLED,f=t,setTimeout(function(){for(;l.length;)i(l.shift())},1)}}function e(t){c===r.PENDING&&(c=r.REJECTED,u=t,setTimeout(function(){for(;l.length;)i(l.shift())},1))}function i(t){return c===r.PENDING?(l.push(t),void 0):(setTimeout(function(){var n;if(c===r.FULFILLED){if(t.onFulfilled){try{n=t.onFulfilled(f)}catch(e){return t.reject(e),void 0}return t.fulfill(n),void 0}return t.fulfill(f),void 0}if(t.onRejected){try{n=t.onRejected(u)}catch(e){return t.reject(e),void 0}return t.fulfill(n),void 0}t.reject(u)},1),void 0)}var o=this,f=null,u=null,r={PENDING:"pending",FULFILLED:"fulfilled",REJECTED:"rejected"},c=r.PENDING,l=[];o.then=function(t,n){return new o.constructor(function(e,o){i({onFulfilled:"function"==typeof t?t:null,onRejected:"function"==typeof n?n:null,fulfill:e,reject:o})})},t(n,e)}return t});